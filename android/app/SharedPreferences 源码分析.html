<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SharedPreferences 源码分析 | Bluesas 的学习笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/assets/favicon.jpg">
    <meta name="description" content="Study, work, thinking">
    
    <link rel="preload" href="/assets/css/0.styles.e115a75d.css" as="style"><link rel="preload" href="/assets/js/app.687e5f1d.js" as="script"><link rel="preload" href="/assets/js/2.aa5b8925.js" as="script"><link rel="preload" href="/assets/js/10.0eea6c9e.js" as="script"><link rel="prefetch" href="/assets/js/11.f7b86da2.js"><link rel="prefetch" href="/assets/js/12.6f4c619a.js"><link rel="prefetch" href="/assets/js/13.a6874013.js"><link rel="prefetch" href="/assets/js/3.58275cf8.js"><link rel="prefetch" href="/assets/js/4.3904ce1c.js"><link rel="prefetch" href="/assets/js/5.6a73b7f6.js"><link rel="prefetch" href="/assets/js/6.79b06d06.js"><link rel="prefetch" href="/assets/js/7.55bb14c4.js"><link rel="prefetch" href="/assets/js/8.3b758077.js"><link rel="prefetch" href="/assets/js/9.47fc82c7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e115a75d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/favicon.jpg" alt="Bluesas 的学习笔记" class="logo"> <span class="site-name can-hide">Bluesas 的学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>SharedPreferences 源码分析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/android/app/SharedPreferences%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html#sharedpreferences" class="sidebar-link">SharedPreferences</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/android/app/SharedPreferences%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html#接口定义" class="sidebar-link">接口定义</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/android/app/SharedPreferences%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html#nested-classes" class="sidebar-link">Nested classes</a></li><li class="sidebar-sub-header"><a href="/android/app/SharedPreferences%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html#public-methods" class="sidebar-link">Public methods</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sharedpreferences-源码分析"><a href="#sharedpreferences-源码分析" class="header-anchor">#</a> SharedPreferences 源码分析</h1> <h2 id="sharedpreferences"><a href="#sharedpreferences" class="header-anchor">#</a> SharedPreferences</h2> <p>SharedPreferences 是 Android 提供的轻量级的数据存储工具。常用于在 Android 中存储简单的 Key-Value 数据。其底层实现是将数据存储到了 xml 文件里。</p> <p>新版本中，谷歌已经在推荐用 DataStore 代替 SharedPreferences 了。</p> <p>这里我们对其源码和实现做一下分析。</p> <p><a href="https://developer.android.google.cn/reference/kotlin/android/content/SharedPreferences" target="_blank" rel="noopener noreferrer">SharedPreferences 文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://developer.android.google.cn/training/data-storage/shared-preferences" target="_blank" rel="noopener noreferrer">Save key-value data<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="接口定义"><a href="#接口定义" class="header-anchor">#</a> 接口定义</h2> <p>先来看 SharedPreferences 的接口定义</p> <h3 id="nested-classes"><a href="#nested-classes" class="header-anchor">#</a> Nested classes</h3> <h4 id="abstract-editor"><a href="#abstract-editor" class="header-anchor">#</a> abstract <strong>Editor</strong></h4> <p>修改 SharedPreference 数据的主要工具。</p> <h4 id="abstract-onsharedpreferencechangelistener"><a href="#abstract-onsharedpreferencechangelistener" class="header-anchor">#</a> abstract <strong>OnSharedPreferenceChangeListener</strong></h4> <p>SharedPreference 变更时的回调监听。</p> <h3 id="public-methods"><a href="#public-methods" class="header-anchor">#</a> Public methods</h3> <h4 id="abstract-contains-key-string-boolean"><a href="#abstract-contains-key-string-boolean" class="header-anchor">#</a> abstract contains(key: String!) : Boolean</h4> <p>Checks whether the preferences contains a preference.                                                                                                                                        |
| abstract SharedPreferences.Editor! | edit()                 | Create a new Editor for these preferences, through which you can make modifications to the data in the preferences and atomically commit those changes back to the SharedPreferences object. |</p> <p>abstract MutableMap&lt;String!, *&gt;!	
getAll()
Retrieve all values from the preferences.</p> <p>abstract Boolean	
getBoolean(key: String!, defValue: Boolean)
Retrieve a boolean value from the preferences.</p> <p>abstract Float	
getFloat(key: String!, defValue: Float)
Retrieve a float value from the preferences.</p> <p>abstract Int	
getInt(key: String!, defValue: Int)
Retrieve an int value from the preferences.</p> <p>abstract Long	
getLong(key: String!, defValue: Long)
Retrieve a long value from the preferences.</p> <p>abstract String?	
getString(key: String!, defValue: String?)
Retrieve a String value from the preferences.</p> <p>abstract MutableSet&lt;String!&gt;?	
getStringSet(key: String!, defValues: MutableSet&lt;String!&gt;?)
Retrieve a set of String values from the preferences.</p> <p>abstract Unit	
registerOnSharedPreferenceChangeListener(listener: SharedPreferences.OnSharedPreferenceChangeListener!)
Registers a callback to be invoked when a change happens to a preference.</p> <p>abstract Unit	
unregisterOnSharedPreferenceChangeListener(listener: SharedPreferences.OnSharedPreferenceChangeListener!)
Unregisters a previous callback.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.687e5f1d.js" defer></script><script src="/assets/js/2.aa5b8925.js" defer></script><script src="/assets/js/10.0eea6c9e.js" defer></script>
  </body>
</html>
